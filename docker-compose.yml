version: "3.8"

services:
  slskd:
    image: slskd/slskd:latest
    container_name: slskd
    restart: unless-stopped
    ports:
      - "5030:5030"
    environment:
      - SLSKD_SLSK_USERNAME=${SOULSEEK_USERNAME}
      - SLSKD_SLSK_PASSWORD=${SOULSEEK_PASSWORD}
      - SLSKD_API_KEY=${SLSKD_API_KEY}
    volumes:
      - slskd-config:/app/config
      - shared-downloads:/app/downloads

  spotify-downloader:
    build: .
    image: niek113/spotify-downloader:latest
    container_name: spotify-downloader
    restart: unless-stopped
    ports:
      - "1337:1337"
    environment:
      - SLSKD_HOST=http://slskd:5030
      - SLSKD_DOWNLOAD_DIR=/slskd-downloads
      - DOWNLOAD_DIR=/output
    volumes:
      - shared-downloads:/slskd-downloads
      - ~/Music/Spotify-DL:/output
      - app-config:/config
    depends_on:
      - slskd

volumes:
  slskd-config:
    driver: local
  shared-downloads:
    driver: local
  output-downloads:
    driver: local
  app-config:
    driver: local
